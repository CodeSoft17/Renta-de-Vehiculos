/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package vista;


import Controlador.ControlVehiculo;
import conexion.Conexion;
import java.awt.HeadlessException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;
import modelo.Vehiculo;

/**
 *
 * @author haru
 */
public class FrmEditarVehiculos extends javax.swing.JInternalFrame {

     
    public FrmEditarVehiculos() {
        initComponents();
        this.setResizable(false);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jPanel3 = new javax.swing.JPanel();
        jPanel4 = new javax.swing.JPanel();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        btnEditar = new javax.swing.JButton();
        lblidclase = new javax.swing.JLabel();
        lblNota = new javax.swing.JLabel();
        lblplaca = new javax.swing.JLabel();
        lblidMarca = new javax.swing.JLabel();
        cmbEleccion = new javax.swing.JComboBox<>();
        jSeparator1 = new javax.swing.JSeparator();
        txtbusqueda = new javax.swing.JTextField();
        lblimodelo = new javax.swing.JLabel();
        lblidcolor = new javax.swing.JLabel();
        lblestado = new javax.swing.JLabel();
        lblidAño = new javax.swing.JLabel();
        lblidVehiculo = new javax.swing.JLabel();
        txtidVehiculo = new javax.swing.JTextField();
        txtPlaca = new javax.swing.JTextField();
        jSeparator3 = new javax.swing.JSeparator();
        jSeparator4 = new javax.swing.JSeparator();
        jSeparator6 = new javax.swing.JSeparator();
        cbmAnio = new javax.swing.JComboBox<>();
        btnsalir = new javax.swing.JButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        tblEditar = new javax.swing.JTable();
        cmbEstado = new javax.swing.JComboBox<>();
        cbmModelo = new javax.swing.JComboBox<>();
        cbmClase = new javax.swing.JComboBox<>();
        cbmColor = new javax.swing.JComboBox<>();
        cbmMarca = new javax.swing.JComboBox<>();
        txtidNota1 = new javax.swing.JTextField();
        btnEliminar = new javax.swing.JButton();
        jLabel15 = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        addInternalFrameListener(new javax.swing.event.InternalFrameListener() {
            public void internalFrameActivated(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameClosed(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameClosing(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameDeactivated(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameDeiconified(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameIconified(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameOpened(javax.swing.event.InternalFrameEvent evt) {
                formInternalFrameOpened(evt);
            }
        });

        jPanel1.setBackground(new java.awt.Color(36, 47, 65));
        jPanel1.setPreferredSize(new java.awt.Dimension(842, 534));
        jPanel1.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel2.setBackground(new java.awt.Color(91, 228, 138));

        jLabel1.setFont(new java.awt.Font("Lucida Grande", 0, 24)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(255, 255, 255));
        jLabel1.setText("Edición de Vehículos");

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel3)
                .addGap(110, 110, 110)
                .addComponent(jLabel1)
                .addContainerGap(755, Short.MAX_VALUE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel3)
                    .addComponent(jLabel1))
                .addGap(23, 23, 23))
        );

        jPanel1.add(jPanel2, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 1300, 50));

        jPanel3.setBackground(new java.awt.Color(36, 47, 65));
        jPanel3.setPreferredSize(new java.awt.Dimension(842, 534));
        jPanel3.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel4.setBackground(new java.awt.Color(91, 228, 138));

        jLabel9.setFont(new java.awt.Font("Lucida Grande", 0, 24)); // NOI18N
        jLabel9.setForeground(new java.awt.Color(255, 255, 255));
        jLabel9.setText("Edición de Vehículos");

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel8)
                .addGap(102, 102, 102)
                .addComponent(jLabel9)
                .addContainerGap(752, Short.MAX_VALUE))
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jLabel8)
                    .addComponent(jLabel9))
                .addGap(16, 16, 16))
        );

        jPanel3.add(jPanel4, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 1300, 50));

        jLabel10.setBackground(new java.awt.Color(255, 255, 255));
        jLabel10.setFont(new java.awt.Font("Lucida Grande", 0, 18)); // NOI18N
        jLabel10.setForeground(new java.awt.Color(255, 255, 255));
        jLabel10.setText("Seleccione una opción de búsqueda");
        jPanel3.add(jLabel10, new org.netbeans.lib.awtextra.AbsoluteConstraints(270, 410, 330, 20));

        btnEditar.setBackground(new java.awt.Color(36, 47, 65));
        btnEditar.setText("Editar");
        btnEditar.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btnEditarMouseClicked(evt);
            }
            public void mousePressed(java.awt.event.MouseEvent evt) {
                btnEditarMousePressed(evt);
            }
        });
        btnEditar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEditarActionPerformed(evt);
            }
        });
        jPanel3.add(btnEditar, new org.netbeans.lib.awtextra.AbsoluteConstraints(290, 350, 70, -1));

        lblidclase.setForeground(new java.awt.Color(255, 255, 255));
        lblidclase.setText("idClase");
        jPanel3.add(lblidclase, new org.netbeans.lib.awtextra.AbsoluteConstraints(390, 160, -1, -1));

        lblNota.setForeground(new java.awt.Color(255, 255, 255));
        lblNota.setText("Nota");
        jPanel3.add(lblNota, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 160, -1, -1));

        lblplaca.setForeground(new java.awt.Color(255, 255, 255));
        lblplaca.setText("Placa");
        jPanel3.add(lblplaca, new org.netbeans.lib.awtextra.AbsoluteConstraints(390, 80, -1, -1));

        lblidMarca.setForeground(new java.awt.Color(255, 255, 255));
        lblidMarca.setText("idMarca");
        jPanel3.add(lblidMarca, new org.netbeans.lib.awtextra.AbsoluteConstraints(690, 250, -1, 20));

        cmbEleccion.setForeground(new java.awt.Color(204, 204, 204));
        cmbEleccion.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "idVehiculo", "Placa", "Estado", "Año", "Modelo", "Color", "Marca" }));
        jPanel3.add(cmbEleccion, new org.netbeans.lib.awtextra.AbsoluteConstraints(270, 460, -1, -1));
        jPanel3.add(jSeparator1, new org.netbeans.lib.awtextra.AbsoluteConstraints(400, 480, 160, -1));

        txtbusqueda.setBackground(new java.awt.Color(36, 47, 65));
        txtbusqueda.setForeground(new java.awt.Color(255, 255, 255));
        txtbusqueda.setBorder(null);
        txtbusqueda.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                txtbusquedaKeyTyped(evt);
            }
        });
        jPanel3.add(txtbusqueda, new org.netbeans.lib.awtextra.AbsoluteConstraints(400, 460, 150, -1));

        lblimodelo.setForeground(new java.awt.Color(255, 255, 255));
        lblimodelo.setText("idmodelo");
        jPanel3.add(lblimodelo, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 250, -1, -1));

        lblidcolor.setForeground(new java.awt.Color(255, 255, 255));
        lblidcolor.setText("idColor");
        jPanel3.add(lblidcolor, new org.netbeans.lib.awtextra.AbsoluteConstraints(390, 250, -1, -1));

        lblestado.setForeground(new java.awt.Color(255, 255, 255));
        lblestado.setText("Estado");
        jPanel3.add(lblestado, new org.netbeans.lib.awtextra.AbsoluteConstraints(690, 80, -1, -1));

        lblidAño.setForeground(new java.awt.Color(255, 255, 255));
        lblidAño.setText("idAño");
        jPanel3.add(lblidAño, new org.netbeans.lib.awtextra.AbsoluteConstraints(690, 160, -1, 20));

        lblidVehiculo.setForeground(new java.awt.Color(255, 255, 255));
        lblidVehiculo.setText("idVehiculo");
        jPanel3.add(lblidVehiculo, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 80, -1, -1));

        txtidVehiculo.setBackground(new java.awt.Color(36, 47, 65));
        txtidVehiculo.setForeground(new java.awt.Color(255, 255, 255));
        txtidVehiculo.setBorder(null);
        txtidVehiculo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtidVehiculoActionPerformed(evt);
            }
        });
        txtidVehiculo.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                txtidVehiculoKeyTyped(evt);
            }
        });
        jPanel3.add(txtidVehiculo, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 100, 90, -1));

        txtPlaca.setBackground(new java.awt.Color(36, 47, 65));
        txtPlaca.setForeground(new java.awt.Color(255, 255, 255));
        txtPlaca.setBorder(null);
        txtPlaca.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                txtPlacaKeyTyped(evt);
            }
        });
        jPanel3.add(txtPlaca, new org.netbeans.lib.awtextra.AbsoluteConstraints(390, 100, 100, 20));
        jPanel3.add(jSeparator3, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 120, 90, 10));
        jPanel3.add(jSeparator4, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 200, 90, 10));
        jPanel3.add(jSeparator6, new org.netbeans.lib.awtextra.AbsoluteConstraints(390, 120, 90, 10));

        jPanel3.add(cbmAnio, new org.netbeans.lib.awtextra.AbsoluteConstraints(680, 180, 120, -1));

        btnsalir.setBackground(new java.awt.Color(36, 47, 65));
        btnsalir.setText("Salir");
        btnsalir.setMaximumSize(new java.awt.Dimension(61, 23));
        btnsalir.setMinimumSize(new java.awt.Dimension(61, 23));
        btnsalir.setPreferredSize(new java.awt.Dimension(61, 23));
        btnsalir.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                btnsalirMousePressed(evt);
            }
        });
        jPanel3.add(btnsalir, new org.netbeans.lib.awtextra.AbsoluteConstraints(510, 350, 70, -1));

        tblEditar.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        tblEditar.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                tblEditarMousePressed(evt);
            }
        });
        jScrollPane1.setViewportView(tblEditar);

        jPanel3.add(jScrollPane1, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 510, 830, 270));

        cmbEstado.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Disponible", "No Disponible" }));
        jPanel3.add(cmbEstado, new org.netbeans.lib.awtextra.AbsoluteConstraints(680, 100, -1, -1));

        jPanel3.add(cbmModelo, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 270, 130, -1));

        jPanel3.add(cbmClase, new org.netbeans.lib.awtextra.AbsoluteConstraints(390, 180, 140, -1));

        jPanel3.add(cbmColor, new org.netbeans.lib.awtextra.AbsoluteConstraints(390, 270, 150, -1));

        jPanel3.add(cbmMarca, new org.netbeans.lib.awtextra.AbsoluteConstraints(680, 270, 120, -1));

        txtidNota1.setBackground(new java.awt.Color(36, 47, 65));
        txtidNota1.setForeground(new java.awt.Color(255, 255, 255));
        txtidNota1.setBorder(null);
        txtidNota1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                txtidNota1KeyTyped(evt);
            }
        });
        jPanel3.add(txtidNota1, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 180, 90, 20));

        btnEliminar.setText("Eliminar");
        btnEliminar.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                btnEliminarMousePressed(evt);
            }
        });
        jPanel3.add(btnEliminar, new org.netbeans.lib.awtextra.AbsoluteConstraints(400, 350, -1, -1));

        jPanel1.add(jPanel3, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 850, 800));

        jLabel15.setForeground(new java.awt.Color(255, 255, 255));
        jLabel15.setText("idVehiculo");
        jPanel1.add(jLabel15, new org.netbeans.lib.awtextra.AbsoluteConstraints(40, 120, -1, -1));

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 853, javax.swing.GroupLayout.PREFERRED_SIZE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 795, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void btnEditarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEditarActionPerformed
       
    }//GEN-LAST:event_btnEditarActionPerformed

    private void txtidVehiculoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtidVehiculoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtidVehiculoActionPerformed

    private void txtidVehiculoKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtidVehiculoKeyTyped
        // TODO add your handling code here:
        char v = evt.getKeyChar();
        if(Character.isLetter(v) || Character.isWhitespace(v)){
            evt.consume();            
        }  
        if(this.txtidVehiculo.getText().length() == 5){
            evt.consume();
        }
    }//GEN-LAST:event_txtidVehiculoKeyTyped

    private void txtPlacaKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtPlacaKeyTyped
        // TODO add your handling code here:
        char v = evt.getKeyChar();
        if(Character.isLetter(v) || Character.isWhitespace(v)){
            evt.consume();            
        }  
        if(this.txtPlaca.getText().length() == 1){
            evt.consume();
        }
    }//GEN-LAST:event_txtPlacaKeyTyped
    
    private void btnEditarMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnEditarMouseClicked
         
    }//GEN-LAST:event_btnEditarMouseClicked

    private void btnsalirMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnsalirMousePressed
        // TODO add your handling code here:
        this.dispose();
    }//GEN-LAST:event_btnsalirMousePressed

    private void formInternalFrameOpened(javax.swing.event.InternalFrameEvent evt) {//GEN-FIRST:event_formInternalFrameOpened
        // TODO add your handling code here:
        mostrarRegistros();
        llenarComboMarca();
        llenarComboColor();
        llenarComboAnio();
        llenarComboModelo();
        llenarComboClase();
    }//GEN-LAST:event_formInternalFrameOpened

    private void tblEditarMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblEditarMousePressed
        // TODO add your handling code here:
        llenarDatos();
    }//GEN-LAST:event_tblEditarMousePressed

    private void txtbusquedaKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtbusquedaKeyTyped
        // TODO add your handling code here:
        buscar();
    }//GEN-LAST:event_txtbusquedaKeyTyped

    private void btnEditarMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnEditarMousePressed
        // TODO add your handling code here:
        editarVehiculo();
        mostrarRegistros();
    }//GEN-LAST:event_btnEditarMousePressed

    private void txtidNota1KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtidNota1KeyTyped
        // TODO add your handling code here:
    }//GEN-LAST:event_txtidNota1KeyTyped

    private void btnEliminarMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnEliminarMousePressed
        // TODO add your handling code here:
        eliminarRegistro();
        mostrarRegistros();
        limpiar();
    }//GEN-LAST:event_btnEliminarMousePressed
    
    public void eliminarRegistro(){
        Vehiculo ve = new Vehiculo();
        ControlVehiculo control = new ControlVehiculo();
        int fila;
        fila = this.tblEditar.getSelectedRow();
        try{
            this.txtidVehiculo.setText(String.valueOf(this.tblEditar.getValueAt(fila, 0)));
            ve.setIdVehiculo(Integer.parseInt(this.txtidVehiculo.getText()));
            int respuesta = JOptionPane.showConfirmDialog(this, "Desea eliminar el Vehiculo seleccionado?", "Eliminar", JOptionPane.YES_NO_OPTION);
            if(respuesta == JOptionPane.OK_OPTION){
                String mensaje = control.eliminarVehiculo(ve);
                JOptionPane.showMessageDialog(this, mensaje, "Resultado", JOptionPane.INFORMATION_MESSAGE);
                this.mostrarRegistros();
            }
        }catch(HeadlessException e){
            JOptionPane.showMessageDialog(this, e.toString(), "Resultado", JOptionPane.ERROR_MESSAGE);
        }
    }
    
    public void mostrarRegistros(){
        String[] columnas = {"idVehiculo", "Modelo", "Marca", "clase", "placa", "color", "anio", "nota", "estado"};
        Object[] obj = new Object[9];
        DefaultTableModel modelo = new DefaultTableModel(null, columnas);
        Conexion con = new Conexion();
        Connection cn;
        PreparedStatement pst;
        ResultSet rs;
        String sql;
        String busqueda;
       try{
            Class.forName(con.getDriver());
            cn = DriverManager.getConnection(con.getUrl(), con.getUsuario(), con.getClave());
            sql = "select * from vehiculosvista";
            pst = cn.prepareStatement(sql);
            rs = pst.executeQuery();
            while(rs.next()){
                obj[0] = rs.getString("idVehiculo");
                obj[1] = rs.getString("modelo");
                obj[2] = rs.getString("marca");
                obj[3] = rs.getString("clase");
                obj[4] = rs.getString("placa");
                obj[5] = rs.getString("color");
                obj[6] = rs.getString("anio");
                obj[7] = rs.getString("nota");
                obj[8] = rs.getString("estado");
                modelo.addRow(obj);
            }
            this.tblEditar.setModel(modelo);
            
        }catch(Exception e){
            JOptionPane.showMessageDialog(this, e.toString(), "Resultado", JOptionPane.ERROR_MESSAGE);
        }
    }
    
    public void llenarComboModelo(){
        Conexion con = new Conexion();
        Connection cn;
        PreparedStatement pst;
        ResultSet rs;
        String sql;
        try{
            Class.forName(con.getDriver());
            cn = DriverManager.getConnection(con.getUrl(), con.getUsuario(), con.getClave());
            sql = "select * from modelo";
            pst = cn.prepareStatement(sql);
            rs = pst.executeQuery();
            while(rs.next()){
                String name = rs.getString("nombre");
                this.cbmModelo.addItem(String.valueOf(name));
            }
            rs.close();
            pst.close();
            cn.close();
        }catch(Exception e){
            JOptionPane.showMessageDialog(this, e.toString(), "Resultado", JOptionPane.ERROR_MESSAGE);
        }
    }
    
    public void llenarComboMarca(){
        Conexion con = new Conexion();
        Connection cn;
        PreparedStatement pst;
        ResultSet rs;
        String sql;
        try{
            Class.forName(con.getDriver());
            cn = DriverManager.getConnection(con.getUrl(), con.getUsuario(), con.getClave());
            sql = "select * from marca";
            pst = cn.prepareStatement(sql);
            rs = pst.executeQuery();
            while(rs.next()){
                String name = rs.getString("nombre");
                this.cbmMarca.addItem(String.valueOf(name));
            }
            rs.close();
            pst.close();
            cn.close();
        }catch(Exception e){
            JOptionPane.showMessageDialog(this, e.toString(), "Resultado", JOptionPane.ERROR_MESSAGE);
        }
    }
    
    public void llenarComboClase(){
        Conexion con = new Conexion();
        Connection cn;
        PreparedStatement pst;
        ResultSet rs;
        String sql;
        try{
            Class.forName(con.getDriver());
            cn = DriverManager.getConnection(con.getUrl(), con.getUsuario(), con.getClave());
            sql = "select * from clase";
            pst = cn.prepareStatement(sql);
            rs = pst.executeQuery();
            while(rs.next()){
                String name = rs.getString("nombre");
                this.cbmClase.addItem(String.valueOf(name));
            }
            rs.close();
            pst.close();
            cn.close();
        }catch(Exception e){
            JOptionPane.showMessageDialog(this, e.toString(), "Resultado", JOptionPane.ERROR_MESSAGE);
        }
    }
    
    public void llenarComboColor(){
        Conexion con = new Conexion();
        Connection cn;
        PreparedStatement pst;
        ResultSet rs;
        String sql;
        try{
            Class.forName(con.getDriver());
            cn = DriverManager.getConnection(con.getUrl(), con.getUsuario(), con.getClave());
            sql = "select * from color";
            pst = cn.prepareStatement(sql);
            rs = pst.executeQuery();
            while(rs.next()){
                String name = rs.getString("nombre");
                this.cbmColor.addItem(String.valueOf(name));
            }
            rs.close();
            pst.close();
            cn.close();
        }catch(Exception e){
            JOptionPane.showMessageDialog(this, e.toString(), "Resultado", JOptionPane.ERROR_MESSAGE);
        }
    }
    
    public void llenarComboAnio(){
        Conexion con = new Conexion();
        Connection cn;
        PreparedStatement pst;
        ResultSet rs;
        String sql;
        try{
            Class.forName(con.getDriver());
            cn = DriverManager.getConnection(con.getUrl(), con.getUsuario(), con.getClave());
            sql = "select * from anio";
            pst = cn.prepareStatement(sql);
            rs = pst.executeQuery();
            while(rs.next()){
                String name = rs.getString("anio");
                this.cbmAnio.addItem(String.valueOf(name));
            }
            rs.close();
            pst.close();
            cn.close();
        }catch(Exception e){
            JOptionPane.showMessageDialog(this, e.toString(), "Resultado", JOptionPane.ERROR_MESSAGE);
        }
    }
    
    public void llenarDatos(){
        int fila = this.tblEditar.getSelectedRow();
        this.txtidVehiculo.setText(String.valueOf(this.tblEditar.getValueAt(fila, 0)));      
        this.cbmModelo.setSelectedItem(this.tblEditar.getValueAt(fila, 1));
        this.cbmMarca.setSelectedItem(this.tblEditar.getValueAt(fila, 2));
        this.cbmClase.setSelectedItem(this.tblEditar.getValueAt(fila, 3));
        this.txtPlaca.setText((String)this.tblEditar.getValueAt(fila, 4));
        this.cbmColor.setSelectedItem(this.tblEditar.getValueAt(fila, 5));
        this.cbmAnio.setSelectedItem(this.tblEditar.getValueAt(fila, 6));
        this.txtidNota1.setText((String)this.tblEditar.getValueAt(fila, 7));
        this.cmbEstado.setSelectedItem(this.tblEditar.getValueAt(fila, 8));
    }
    
    public Integer recogerid(String busqueda, String tabla, String columna, String cmb){
        Conexion con = new Conexion();
        Connection cn;
        PreparedStatement pst;
        ResultSet rs;
        String sql;
        String resultado = null;
        int res = 0;
       try{
            Class.forName(con.getDriver());
            cn = DriverManager.getConnection(con.getUrl(), con.getUsuario(), con.getClave());
            sql = "select " + busqueda + " from " + tabla + " where " + columna + " like '" + cmb +"%'"; 
            pst = cn.prepareStatement(sql);
            rs = pst.executeQuery();
            while(rs.next()){
                resultado = rs.getString(busqueda);
            }
            res = Integer.valueOf(resultado);
        }catch(ClassNotFoundException | SQLException e){
            JOptionPane.showMessageDialog(this, e.toString(), "Resultado", JOptionPane.ERROR_MESSAGE);
        }
       return res;
    }
    
    public void editarVehiculo(){
        Vehiculo vehiculo = new Vehiculo();
        ControlVehiculo control = new ControlVehiculo();
        try{
          vehiculo.setIdVehiculo(Integer.valueOf(this.txtidVehiculo.getText()));
          vehiculo.setPlaca(this.txtPlaca.getText());         
          vehiculo.setEstado((String) this.cmbEstado.getSelectedItem());          
          vehiculo.setNota(Integer.valueOf(this.txtidNota1.getText()));
          
          //Id Clase
          String busqueda = "idClase";
          String tabla = "clase";
          String columna = "nombre";
          String cmb = (String)this.cbmClase.getSelectedItem();
          vehiculo.setIdClase(recogerid(busqueda, tabla, columna, cmb));         
          //idanio
          busqueda = "idanio";
          tabla = "anio";
          columna = "anio";
          cmb = (String)this.cbmAnio.getSelectedItem();
          vehiculo.setIdanio(recogerid(busqueda, tabla, columna, cmb));          
          //idModelo
          busqueda = "idModelo";
          tabla = "modelo";
          columna = "nombre";
          cmb = (String)this.cbmModelo.getSelectedItem();
          vehiculo.setIdModelo(recogerid(busqueda, tabla, columna, cmb));
          //idColor
          busqueda = "idColor";
          tabla = "color";
          columna = "nombre";
          cmb = (String)this.cbmColor.getSelectedItem();         
          vehiculo.setIdColor(recogerid(busqueda, tabla, columna, cmb));
          //idMarca
          busqueda = "idMarca";
          tabla = "marca";
          columna = "nombre";
          cmb = (String)this.cbmMarca.getSelectedItem();         
          vehiculo.setIdMarca(recogerid(busqueda, tabla, columna, cmb));
                   
          String mensaje = control.modificarVehiculo(vehiculo);
          JOptionPane.showMessageDialog(this, mensaje, "Resultado", JOptionPane.INFORMATION_MESSAGE);
          limpiar();
        }catch(HeadlessException | NumberFormatException e){
           JOptionPane.showMessageDialog(this, e.toString(), "Error", JOptionPane.ERROR_MESSAGE);  
        }
    }
    
    public void buscar(){
        String[] columnas = {"idVehiculo", "Modelo", "Marca", "Clase", "Placa", "Color", "Anio", "Nota", "Estado"};
        Object[] obj = new Object[9];
        DefaultTableModel modelo = new DefaultTableModel(null, columnas);
        Conexion con = new Conexion();
        Connection cn;
        PreparedStatement pst;
        ResultSet rs;
        String sql;
        String busqueda;
       try{
            Class.forName(con.getDriver());
            cn = DriverManager.getConnection(con.getUrl(), con.getUsuario(), con.getClave());
            busqueda = this.txtbusqueda.getText();
            String eleccion = (String)this.cmbEleccion.getSelectedItem();
            sql = "select * from vehiculosvista where " + eleccion + " like '" + busqueda + "%'";
            pst = cn.prepareStatement(sql);
            rs = pst.executeQuery();
            while(rs.next()){
                obj[0] = rs.getString("idVehiculo");
                obj[1] = rs.getString("modelo");
                obj[2] = rs.getString("marca");
                obj[3] = rs.getString("clase");
                obj[4] = rs.getString("placa");
                obj[5] = rs.getString("color");
                obj[6] = rs.getString("anio");
                obj[7] = rs.getString("nota");
                obj[8] = rs.getString("estado");
                modelo.addRow(obj);
            }
            this.tblEditar.setModel(modelo);
            
        }catch(ClassNotFoundException | SQLException e){
            JOptionPane.showMessageDialog(this, e.toString(), "Resultado", JOptionPane.ERROR_MESSAGE);
        }
    }
    
    public void limpiar(){
        this.txtidVehiculo.setText("");
        this.txtPlaca.setText("");
        this.txtbusqueda.setText("");
        this.txtPlaca.setText("");
        this.cbmAnio.setSelectedItem(0);
        this.cbmClase.setSelectedItem(0);
        this.cbmColor.setSelectedItem(0);
        this.cbmMarca.setSelectedItem(0);
        this.cbmModelo.setSelectedItem(0);
        this.cmbEstado.setSelectedItem(0);
    }
    
    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(FrmEditarVehiculos.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(FrmEditarVehiculos.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(FrmEditarVehiculos.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(FrmEditarVehiculos.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new FrmEditarVehiculos().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnEditar;
    private javax.swing.JButton btnEliminar;
    private javax.swing.JButton btnsalir;
    private javax.swing.JComboBox<String> cbmAnio;
    private javax.swing.JComboBox<String> cbmClase;
    private javax.swing.JComboBox<String> cbmColor;
    private javax.swing.JComboBox<String> cbmMarca;
    private javax.swing.JComboBox<String> cbmModelo;
    private javax.swing.JComboBox<String> cmbEleccion;
    private javax.swing.JComboBox<String> cmbEstado;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JSeparator jSeparator3;
    private javax.swing.JSeparator jSeparator4;
    private javax.swing.JSeparator jSeparator6;
    private javax.swing.JLabel lblNota;
    private javax.swing.JLabel lblestado;
    private javax.swing.JLabel lblidAño;
    private javax.swing.JLabel lblidMarca;
    private javax.swing.JLabel lblidVehiculo;
    private javax.swing.JLabel lblidclase;
    private javax.swing.JLabel lblidcolor;
    private javax.swing.JLabel lblimodelo;
    private javax.swing.JLabel lblplaca;
    private javax.swing.JTable tblEditar;
    private javax.swing.JTextField txtPlaca;
    private javax.swing.JTextField txtbusqueda;
    private javax.swing.JTextField txtidNota1;
    private javax.swing.JTextField txtidVehiculo;
    // End of variables declaration//GEN-END:variables
}
